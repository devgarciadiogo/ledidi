<?php
// Conexão com o banco de dados
$conn = mysqli_connect("localhost", "root", "", "ledidi_db");

// Verifica se a conexão foi estabelecida com sucesso
if (!$conn) {
  echo "Erro de conexão: " . mysqli_connect_error();
  exit;
}

// Recebe os dados do formulário
$telefone = mysqli_real_escape_string($conn, $_POST['telefone']);
$dataHora = mysqli_real_escape_string($conn, $_POST['dataHora']);
$servico = mysqli_real_escape_string($conn, $_POST['servico']);
$profissional = mysqli_real_escape_string($conn, $_POST['profissional']);

// Query para inserir os dados do agendamento no banco de dados
$query = "INSERT INTO agendamentos (telefone, data_hora, servico, profissional) VALUES ('$telefone', '$dataHora', '$servico', '$profissional')";

// Executa a query
$result = mysqli_query($conn, $query);

// Verifica se a query foi executada com sucesso
if ($result) {
  // Retorna uma resposta em JSON indicando sucesso
  echo json_encode(array("mensagem" => "Agendamento realizado com sucesso!"));
} else {
  // Retorna uma resposta em JSON indicando erro
  echo json_encode(array("mensagem" => "Erro ao agendar: " . mysqli_error($conn)));
}

// Fecha a conexão com o banco de dados
mysqli_close($conn);
?>
